<!DOCTYPE html>
<html lang="es-AR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TecniYa - Setup Inicial</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 900px;
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #0a4fd8 0%, #1a60f0 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .content {
            padding: 40px;
        }
        
        .step {
            margin-bottom: 40px;
            padding: 25px;
            border-radius: 12px;
            background: #f8f9fa;
            border-left: 4px solid #0a4fd8;
        }
        
        .step h3 {
            color: #0a4fd8;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .step p {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 15px 30px;
            background: linear-gradient(135deg, #0a4fd8 0%, #1a60f0 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(10, 79, 216, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }
        
        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .alert {
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            font-weight: 600;
        }
        
        .alert-warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            color: #856404;
        }
        
        .alert-danger {
            background: #f8d7da;
            border: 2px solid #dc3545;
            color: #721c24;
        }
        
        .alert-success {
            background: #d4edda;
            border: 2px solid #28a745;
            color: #155724;
        }
        
        .log-container {
            background: #1a202c;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .log-entry {
            padding: 5px 0;
            border-bottom: 1px solid #2d3748;
        }
        
        .log-success {
            color: #68d391;
        }
        
        .log-error {
            color: #fc8181;
        }
        
        .log-info {
            color: #63b3ed;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        .status-active {
            background: #28a745;
            box-shadow: 0 0 10px #28a745;
        }
        
        .status-inactive {
            background: #dc3545;
        }
        
        .firebase-config {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .firebase-config h4 {
            color: #0a4fd8;
            margin-bottom: 15px;
        }
        
        .config-field {
            margin-bottom: 15px;
        }
        
        .config-field label {
            display: block;
            font-weight: 600;
            margin-bottom: 5px;
            color: #495057;
        }
        
        .config-field input {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
            transition: border 0.3s;
        }
        
        .config-field input:focus {
            border-color: #0a4fd8;
            outline: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîß TecniYa - Setup Inicial</h1>
            <p>Configuraci√≥n completa de la base de datos Firestore</p>
        </div>
        
        <div class="content">
            <div class="alert alert-warning">
                ‚ö†Ô∏è <strong>ADVERTENCIA:</strong> Esta p√°gina debe ejecutarse UNA SOLA VEZ despu√©s de crear el proyecto en Firebase.
                Solo usala si est√°s comenzando desde cero.
            </div>
            
            <div class="step">
                <h3>Paso 1: Configuraci√≥n de Firebase</h3>
                <p>Verific√° que Firebase est√© correctamente configurado en tu proyecto.</p>
                
                <div class="firebase-config">
                    <h4>Configuraci√≥n actual:</h4>
                    <div class="config-field">
                        <label>Project ID:</label>
                        <input type="text" value="tecniya-b4206" readonly>
                    </div>
                    <div class="config-field">
                        <label>API Key:</label>
                        <input type="text" value="AIzaSyBzDfYDdzmN9J_Y8gG06aqH0OtlzFhafFY" readonly>
                    </div>
                    <div class="config-field">
                        <label>Status: <span class="status-indicator status-active"></span> Conectado</label>
                    </div>
                </div>
            </div>
            
            <div class="step">
                <h3>Paso 2: Crear Colecciones e √çndices</h3>
                <p>Este proceso crear√° todas las colecciones necesarias con sus √≠ndices para que la aplicaci√≥n funcione correctamente.</p>
                
                <div class="code-block">
                    // Colecciones a crear:<br>
                    1. professionals - T√©cnicos registrados<br>
                    2. quotes - Presupuestos creados<br>
                    3. banners - Banners publicitarios<br>
                    4. admin_users - Usuarios administradores<br>
                    5. admin_config - Configuraci√≥n del sistema<br>
                    6. stats - Estad√≠sticas globales<br>
                    7. province_stats - Estad√≠sticas por provincia<br>
                    8. ads_clicks - Registro de clicks en banners
                </div>
                
                <div class="btn-group">
                    <button id="setupBtn" class="btn">
                        ‚öôÔ∏è Ejecutar Setup Completo
                    </button>
                    <button id="testConnectionBtn" class="btn btn-success">
                        üîó Testear Conexi√≥n
                    </button>
                </div>
            </div>
            
            <div class="step">
                <h3>Paso 3: Crear Usuario Administrador</h3>
                <p>Cre√° el primer usuario administrador para acceder al panel de control.</p>
                
                <div class="firebase-config">
                    <div class="config-field">
                        <label>Email del administrador:</label>
                        <input type="email" id="adminEmail" placeholder="admin@tecniya.com">
                    </div>
                    <div class="config-field">
                        <label>Contrase√±a:</label>
                        <input type="password" id="adminPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                    <div class="config-field">
                        <label>Nombre:</label>
                        <input type="text" id="adminName" placeholder="Administrador Principal">
                    </div>
                </div>
                
                <div class="btn-group">
                    <button id="createAdminBtn" class="btn">
                        üëë Crear Administrador
                    </button>
                </div>
            </div>
            
            <div id="logSection" style="display: none;">
                <h3 style="color: #0a4fd8; margin-bottom: 15px;">Log de Ejecuci√≥n</h3>
                <div class="log-container" id="logOutput">
                    <!-- Los logs aparecer√°n aqu√≠ -->
                </div>
            </div>
            
            <div id="successMessage" class="alert alert-success" style="display: none;">
                ‚úÖ <strong>¬°Setup completado con √©xito!</strong> La aplicaci√≥n est√° lista para usar.
            </div>
            
            <div class="step">
                <h3>Paso 4: Verificar Instalaci√≥n</h3>
                <p>Despu√©s de completar el setup, verific√° que todo funcione correctamente.</p>
                
                <div class="btn-group">
                    <a href="index.html" target="_blank" class="btn btn-success">
                        üåê Ver Sitio Principal
                    </a>
                    <a href="admin.html" target="_blank" class="btn">
                        ‚öôÔ∏è Ir al Panel Admin
                    </a>
                    <a href="profesional.html" target="_blank" class="btn">
                        üë®‚Äçüîß Panel Profesional
                    </a>
                </div>
                
                <div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #dee2e6;">
                    <p><strong>Acciones de mantenimiento:</strong></p>
                    <div class="btn-group">
                        <button id="clearCollectionsBtn" class="btn btn-danger">
                            üóëÔ∏è Limpiar Colecciones (PELIGROSO)
                        </button>
                        <button id="createSampleDataBtn" class="btn">
                            üìä Crear Datos de Ejemplo
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    
    <script>
        // ============================================
        // CONFIGURACI√ìN FIREBASE
        // ============================================
        const firebaseConfig = {
            apiKey: "AIzaSyBzDfYDdzmN9J_Y8gG06aqH0OtlzFhafFY",
            authDomain: "tecniya-b4206.firebaseapp.com",
            projectId: "tecniya-b4206",
            storageBucket: "tecniya-b4206.firebasestorage.app",
            messagingSenderId: "166424133304",
            appId: "1:166424133304:web:d1ad23bd4ea1af10437e4d"
        };
        
        // ============================================
        // INICIALIZAR FIREBASE
        // ============================================
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        
        // ============================================
        // VARIABLES
        // ============================================
        let logOutput = document.getElementById('logOutput');
        let logSection = document.getElementById('logSection');
        let successMessage = document.getElementById('successMessage');
        
        // ============================================
        // FUNCIONES DE LOG
        // ============================================
        function log(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            logOutput.appendChild(entry);
            logOutput.scrollTop = logOutput.scrollHeight;
            logSection.style.display = 'block';
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        function clearLog() {
            logOutput.innerHTML = '';
        }
        
        // ============================================
        // TESTEAR CONEXI√ìN
        // ============================================
        document.getElementById('testConnectionBtn').addEventListener('click', async () => {
            clearLog();
            log('üîó Probando conexi√≥n con Firebase...', 'info');
            
            try {
                // Intentar una operaci√≥n simple
                const testRef = db.collection('test_connection').doc('test');
                await testRef.set({
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    message: 'Conexi√≥n de prueba'
                });
                
                await testRef.delete();
                
                log('‚úÖ Conexi√≥n exitosa con Firebase Firestore', 'success');
                log('‚úÖ Firebase Auth est√° funcionando', 'success');
                log('‚úÖ Proyecto: tecniya-b4206', 'info');
                
            } catch (error) {
                log(`‚ùå Error de conexi√≥n: ${error.message}`, 'error');
                log('‚ö†Ô∏è Verific√° la configuraci√≥n de Firebase', 'info');
            }
        });
        
        // ============================================
        // EJECUTAR SETUP COMPLETO
        // ============================================
        document.getElementById('setupBtn').addEventListener('click', async () => {
            clearLog();
            log('üöÄ Iniciando setup completo de TecniYa...', 'info');
            
            try {
                // 1. Crear administrador por defecto
                log('1. Creando usuario administrador por defecto...', 'info');
                await createDefaultAdmin();
                
                // 2. Crear configuraci√≥n del sistema
                log('2. Configurando sistema...', 'info');
                await createSystemConfig();
                
                // 3. Crear estad√≠sticas globales
                log('3. Creando estad√≠sticas globales...', 'info');
                await createGlobalStats();
                
                // 4. Crear √≠ndices necesarios (explicaci√≥n)
                log('4. Configurando √≠ndices de Firestore...', 'info');
                log('üìù Nota: Los √≠ndices se crean autom√°ticamente cuando Firestore detecta la necesidad.', 'info');
                log('üìù Para mejor performance, cre√° estos √≠ndices en Firebase Console:', 'info');
                log('   - professionals: userId (Ascending)', 'info');
                log('   - professionals: provincia, ciudad, profileCompleted', 'info');
                log('   - professionals: rubros (array-contains)', 'info');
                log('   - quotes: professionalId, createdAt (Descending)', 'info');
                log('   - banners: provincia, ciudad, active', 'info');
                
                // 5. Crear datos de ejemplo (opcional)
                const createSample = confirm('¬øCrear datos de ejemplo para pruebas?');
                if (createSample) {
                    log('5. Creando datos de ejemplo...', 'info');
                    await createSampleData();
                }
                
                log('‚úÖ Setup completado exitosamente!', 'success');
                successMessage.style.display = 'block';
                
                log('üìã Resumen de colecciones creadas:', 'info');
                log('   ‚Ä¢ professionals - T√©cnicos registrados', 'info');
                log('   ‚Ä¢ quotes - Presupuestos', 'info');
                log('   ‚Ä¢ banners - Publicidad', 'info');
                log('   ‚Ä¢ admin_users - Administradores', 'info');
                log('   ‚Ä¢ admin_config - Configuraci√≥n', 'info');
                log('   ‚Ä¢ stats - Estad√≠sticas', 'info');
                log('   ‚Ä¢ province_stats - Estad√≠sticas por provincia', 'info');
                log('   ‚Ä¢ ads_clicks - Clicks en banners', 'info');
                
            } catch (error) {
                log(`‚ùå Error en el setup: ${error.message}`, 'error');
                log('‚ö†Ô∏è Revis√° la consola para m√°s detalles', 'info');
            }
        });
        
        // ============================================
        // CREAR ADMINISTRADOR POR DEFECTO
        // ============================================
        async function createDefaultAdmin() {
            try {
                const adminData = {
                    email: "admin@tecniya.com",
                    name: "Administrador Principal",
                    role: "superadmin",
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    lastLogin: null
                };
                
                await db.collection('admin_users').doc('admin@tecniya.com').set(adminData);
                log('‚úÖ Usuario administrador creado: admin@tecniya.com', 'success');
                
            } catch (error) {
                log(`‚ö†Ô∏è Administrador ya existe o error: ${error.message}`, 'info');
            }
        }
        
        // ============================================
        // CREAR CONFIGURACI√ìN DEL SISTEMA
        // ============================================
        async function createSystemConfig() {
            try {
                const config = {
                    featuredPrice: 9000,
                    certificationPrice: 5000,
                    bannersEnabled: true,
                    newCitiesEnabled: true,
                    defaultProvince: "Santa Fe",
                    defaultCity: "Rosario",
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                };
                
                await db.collection('admin_config').doc('config').set(config);
                log('‚úÖ Configuraci√≥n del sistema creada', 'success');
                
            } catch (error) {
                log(`‚ö†Ô∏è Configuraci√≥n ya existe o error: ${error.message}`, 'info');
            }
        }
        
        // ============================================
        // CREAR ESTAD√çSTICAS GLOBALES
        // ============================================
        async function createGlobalStats() {
            try {
                const stats = {
                    totalProfessionals: 0,
                    totalJobs: 0,
                    avgRating: 4.8,
                    totalQuotes: 0,
                    totalCities: 24,
                    totalProvinces: 23,
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                };
                
                await db.collection('stats').doc('global').set(stats);
                log('‚úÖ Estad√≠sticas globales inicializadas', 'success');
                
            } catch (error) {
                log(`‚ö†Ô∏è Estad√≠sticas ya existen o error: ${error.message}`, 'info');
            }
        }
        
        // ============================================
        // CREAR ADMINISTRADOR PERSONALIZADO
        // ============================================
        document.getElementById('createAdminBtn').addEventListener('click', async () => {
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;
            const name = document.getElementById('adminName').value;
            
            if (!email || !password || !name) {
                alert('Complet√° todos los campos');
                return;
            }
            
            if (password.length < 6) {
                alert('La contrase√±a debe tener al menos 6 caracteres');
                return;
            }
            
            clearLog();
            log(`üëë Creando administrador: ${email}`, 'info');
            
            try {
                // Crear usuario en Firebase Auth
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                
                // Actualizar nombre del usuario
                await userCredential.user.updateProfile({ displayName: name });
                
                // Crear registro en admin_users
                const adminData = {
                    email: email,
                    name: name,
                    role: "admin",
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    lastLogin: null
                };
                
                await db.collection('admin_users').doc(email).set(adminData);
                
                log(`‚úÖ Administrador creado exitosamente: ${email}`, 'success');
                log(`üìß Email: ${email}`, 'info');
                log(`üë§ Nombre: ${name}`, 'info');
                log(`üîë Contrase√±a: ${'*'.repeat(password.length)}`, 'info');
                log('üí° Guard√° estas credenciales en un lugar seguro', 'info');
                
                // Limpiar formulario
                document.getElementById('adminEmail').value = '';
                document.getElementById('adminPassword').value = '';
                document.getElementById('adminName').value = '';
                
            } catch (error) {
                log(`‚ùå Error creando administrador: ${error.message}`, 'error');
            }
        });
        
        // ============================================
        // CREAR DATOS DE EJEMPLO
        // ============================================
        async function createSampleData() {
            try {
                // Crear algunos profesionales de ejemplo
                const sampleProfessionals = [
                    {
                        name: "Juan P√©rez",
                        email: "juan@ejemplo.com",
                        phone: "5493411234567",
                        provincia: "Santa Fe",
                        ciudad: "Rosario",
                        zonas: ["Centro", "Norte"],
                        rubros: ["plomeria", "gas"],
                        photoUrl: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=200&fit=crop",
                        bio: "Plomero con 10 a√±os de experiencia en instalaciones residenciales.",
                        rating: 4.8,
                        jobsCompleted: 45,
                        profileCompleted: true,
                        isFeatured: true,
                        featuredUntil: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), // 30 d√≠as
                        certified: true,
                        rankingScore: 95,
                        blocked: false,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        lastActive: firebase.firestore.FieldValue.serverTimestamp()
                    },
                    {
                        name: "Mar√≠a Gonz√°lez",
                        email: "maria@ejemplo.com",
                        phone: "5493417654321",
                        provincia: "C√≥rdoba",
                        ciudad: "C√≥rdoba",
                        zonas: ["Centro", "Nueva C√≥rdoba"],
                        rubros: ["electricidad", "aire"],
                        photoUrl: "https://images.unsplash.com/photo-1494790108755-2616b786d4d9?w=200&h=200&fit=crop",
                        bio: "Electricista certificada especializada en instalaciones modernas.",
                        rating: 4.9,
                        jobsCompleted: 32,
                        profileCompleted: true,
                        isFeatured: false,
                        certified: true,
                        rankingScore: 88,
                        blocked: false,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        lastActive: firebase.firestore.FieldValue.serverTimestamp()
                    },
                    {
                        name: "Carlos Rodr√≠guez",
                        email: "carlos@ejemplo.com",
                        phone: "5493419876543",
                        provincia: "Buenos Aires",
                        ciudad: "La Plata",
                        zonas: ["Centro", "City Bell"],
                        rubros: ["albanileria", "pintura"],
                        photoUrl: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=200&h=200&fit=crop",
                        bio: "Alba√±il y pintor con amplia experiencia en refacciones.",
                        rating: 4.7,
                        jobsCompleted: 28,
                        profileCompleted: true,
                        isFeatured: true,
                        featuredUntil: new Date(Date.now() + 15 * 24 * 60 * 60 * 1000), // 15 d√≠as
                        certified: false,
                        rankingScore: 82,
                        blocked: false,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        lastActive: firebase.firestore.FieldValue.serverTimestamp()
                    }
                ];
                
                // Crear profesionales
                const batch = db.batch();
                sampleProfessionals.forEach((prof, index) => {
                    const ref = db.collection('professionals').doc(`sample_${index + 1}`);
                    batch.set(ref, prof);
                });
                
                await batch.commit();
                log(`‚úÖ ${sampleProfessionals.length} profesionales de ejemplo creados`, 'success');
                
                // Crear banners de ejemplo
                const sampleBanners = [
                    {
                        title: "Oferta Especial en Herramientas",
                        link: "https://ejemplo.com/herramientas",
                        imageUrl: "https://images.unsplash.com/photo-1581094794329-c8112a89af12?w=800&h-200&fit=crop",
                        provincia: "toda",
                        ciudad: "toda",
                        rubros: ["todos"],
                        position: "home",
                        priority: 10,
                        active: true,
                        startDate: new Date(),
                        endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    },
                    {
                        title: "Materiales de Construcci√≥n en Rosario",
                        link: "https://ejemplo.com/materiales-rosario",
                        imageUrl: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=800&h=200&fit=crop",
                        provincia: "Santa Fe",
                        ciudad: "Rosario",
                        rubros: ["albanileria", "pintura"],
                        position: "results",
                        priority: 8,
                        active: true,
                        startDate: new Date(),
                        endDate: new Date(Date.now() + 15 * 24 * 60 * 60 * 1000),
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    }
                ];
                
                const bannerBatch = db.batch();
                sampleBanners.forEach((banner, index) => {
                    const ref = db.collection('banners').doc(`banner_${index + 1}`);
                    bannerBatch.set(ref, banner);
                });
                
                await bannerBatch.commit();
                log(`‚úÖ ${sampleBanners.length} banners de ejemplo creados`, 'success');
                
                // Actualizar estad√≠sticas
                await db.collection('stats').doc('global').update({
                    totalProfessionals: sampleProfessionals.length
                });
                
                log('üìä Estad√≠sticas actualizadas con datos de ejemplo', 'info');
                
            } catch (error) {
                log(`‚ö†Ô∏è Error creando datos de ejemplo: ${error.message}`, 'info');
            }
        }
        
        // ============================================
        // BOT√ìN PARA CREAR DATOS DE EJEMPLO
        // ============================================
        document.getElementById('createSampleDataBtn').addEventListener('click', async () => {
            clearLog();
            await createSampleData();
        });
        
        // ============================================
        // LIMPIAR COLECCIONES (PELIGROSO)
        // ============================================
        document.getElementById('clearCollectionsBtn').addEventListener('click', async () => {
            if (!confirm('‚ö†Ô∏è ¬°PELIGRO! Esta acci√≥n eliminar√° TODOS los datos.\n¬øEst√°s absolutamente seguro?')) {
                return;
            }
            
            if (!confirm('‚ö†Ô∏è Esta acci√≥n es IRREVERSIBLE.\n¬øRealmente quer√©s proceder?')) {
                return;
            }
            
            clearLog();
            log('üóëÔ∏è Iniciando limpieza de colecciones...', 'info');
            
            try {
                // Lista de colecciones a limpiar
                const collections = [
                    'professionals',
                    'quotes',
                    'banners',
                    'ads_clicks'
                ];
                
                for (const collectionName of collections) {
                    log(`Limpiando colecci√≥n: ${collectionName}...`, 'info');
                    
                    const snapshot = await db.collection(collectionName).get();
                    const batch = db.batch();
                    
                    snapshot.docs.forEach(doc => {
                        batch.delete(doc.ref);
                    });
                    
                    await batch.commit();
                    log(`‚úÖ ${snapshot.size} documentos eliminados de ${collectionName}`, 'success');
                }
                
                // Reiniciar estad√≠sticas
                await db.collection('stats').doc('global').update({
                    totalProfessionals: 0,
                    totalJobs: 0,
                    totalQuotes: 0
                });
                
                log('‚úÖ Todas las colecciones fueron limpiadas', 'success');
                log('üìä Estad√≠sticas reiniciadas a cero', 'info');
                log('‚ö†Ô∏è La aplicaci√≥n est√° ahora en estado inicial', 'info');
                
            } catch (error) {
                log(`‚ùå Error limpiando colecciones: ${error.message}`, 'error');
            }
        });
        
        // ============================================
        // TEST INICIAL DE CONEXI√ìN
        // ============================================
        document.addEventListener('DOMContentLoaded', () => {
            log('üöÄ Setup de TecniYa cargado', 'info');
            log(`üìÖ ${new Date().toLocaleDateString('es-AR')} ${new Date().toLocaleTimeString('es-AR')}`, 'info');
            log('üåê Proyecto: tecniya-b4206', 'info');
            log('üìÅ Firebase Firestore inicializado', 'success');
        });
    </script>
</body>
</html>
